<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SMILE-PARKING</title>
    <!-- Enlazar Bootstrap CSS -->
    <link rel="stylesheet" href="../bootstrap/bootstrap.min.css">
    <!-- Estilos personalizados para la página -->
    <style>
        body {
            background: linear-gradient(to bottom, #ffffff, #ffffff);
        }
        /* Estilos para el menú en un div con fondo verde */
        #menuContainer {
            background-color: green;
            padding: 10px 0;
            text-align: center;
        }
        /* Alineación horizontal para las imágenes del menú */
        .menu-image {
            display: inline-block;
            margin: 0 10px; /* Espacio entre las imágenes */
            height: 50px;
            width: 40px;
        }
        .container {
            text-align: center;
            padding-top: 10px;
        }
        .image {
            max-width: 100%;
            height: auto;
        }
        .profile-image {
            max-width: 100px;
            max-height: 100px;
            border-radius: 50%;
        }
        .carousel {
            max-width: 80%;
            margin: 0 auto;
        }
        img {
            cursor: pointer;
            transition: transform 0.3s;
        }
        img:hover {
            transform: scale(1.2);
        }
        .qr-code {
            max-width: 100px;
            cursor: pointer;
        }
        .camera-icon {
            width: 50px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .camera-icon:hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <!-- Menú en un div con fondo verde -->
    <div id="menuContainer">
        <!-- Alineación horizontal para las imágenes del menú -->
        <img src="../img/menu-icon.png" class="icon menu-image">
        <!-- Imagen en el centro -->
        <img src="../img/fondo-index.jpg" class="image" style="height: 50px; width: 60%;">
        <!-- Imagen de perfil (simulación) -->
        <img src="../img/perfil.png" class="profile-image menu-image">
    </div>
    
    <!-- Contenedor principal -->
    <div class="container">
        <!-- Saludo con el nombre del usuario -->
        <p>Hola, <span id="userFullName"></span></p>
        
        <!-- Carrusel de imágenes -->
        <div id="imageCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="../img/img1.jpg" class="image" style="width: 100%; height: 200px;">
                </div>
                <div class="carousel-item">
                    <img src="../img/img2.jpg" class="image" style="width: 100%; height: 200px;">
                </div>
            </div>
        </div>

        <!-- Imágenes pequeñas que aumentan de tamaño al hacer clic -->
        <div class="mt-3">
            <img src="../img/auto.png" class="car-images" alt="Auto" id="carImage">
            <img src="../img/camioneta.png" class="car-images" alt="Camioneta" id="truckImage">
            <img src="../img/moto.png" class="car-images" alt="Moto" id="motorcycleImage">
        </div>

        <div class="mt-3">
            <p class="font-italic"> &darr; Escanea el QR &darr;</p>
            <img src="../img/camara.png" class="camera-icon" alt="Cámara" style="width: 80px; height: 80px;">
        </div>
        <br>
        <!-- Agregar un botón para cerrar sesión -->
        <button class="btn btn-danger" id="cerrarSesion">Cerrar Sesión</button>

    </div>

    <!-- Ventana Emergente 1 - Validando -->
    <div id="popup1" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Validando...</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="../img/escaneando.png" alt="Validando" style="width: 100%; height:350px;">
                    <p>Validación en curso...</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="continueToPopup2">Continuar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ventana Emergente 2 - Ingreso Validado -->
    <div id="popup2" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ingreso Validado</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="../img/mall.png" style="width: 100%; height:200px;">
                    <p>Tu ingreso ha sido validado.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="continueToPopup3">Continuar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ventana Emergente 3 - Seleccione Entrada -->
    <div id="popup3" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Seleccione una entrada</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="../img/aparcamiento.jpg" style="width: 100%; height:100px;">
                    <button type="button" class="btn btn-primary" id="selectTottus">Entrada Tottus</button>
                    <hr>
                    <img src="../img/preferencial.jpg" style="width: 100%; height:100px;">
                    <button type="button" class="btn btn-primary" id="selectPreferential">Entrada Preferencial</button>
                    <hr>
                    <img src="../img/zotano.jpg" style="width: 100%; height:100px;">
                    <button type="button" class="btn btn-primary" id="selectZotano">Entrada Zotano</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Ventana Emergente 4 - Elegir Posición -->
<div id="popup4" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Elija una posición</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Seleccionaste: <span id="selectedEntranceInPopup4"></span></p>
                <p>Elija una posición:</p>
                <div class="container">
                    <div class="row" id="casillas" style="background-image: url('../img/croquis.jpeg'); background-size: 100% 125px;background-repeat: no-repeat; ">
                        <div class="col-6">
                            <label for="position1">Posición 1</label>
                            <input type="checkbox" id="position1">
                        </div>
                        <div class="col-6">
                            <label for="position2">Posición 2</label>
                            <input type="checkbox" id="position2">
                        </div>
                        <div class="col-6">
                            <label for="position3" style="margin-left: 63px;">3</label>
                            <input type="checkbox" id="position3">
                        </div>
                        <div class="col-6">
                            <label for="position4">Posición 4</label>
                            <input type="checkbox" id="position4">
                        </div>
                        <div class="col-6">
                            <label for="position5"style="margin-left: 63px;">5</label>
                            <input type="checkbox" id="position5">
                        </div>
                        <div class="col-6">
                            <label for="position6">Posición 6</label>
                            <input type="checkbox" id="position6">
                        </div>
                        <div class="col-6">
                            <label for="position7">Posición 7</label>
                            <input type="checkbox" id="position7">
                        </div>
                        <div class="col-6">
                            <label for="position8" style="margin-left: 63px;">8</label>
                            <input type="checkbox" id="position8">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="markPosition">Marcar</button>
                

            </div>
        </div>
    </div>
</div>
<!-- Ventana Emergente con una imagen -->
<div id="popupmapa" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document"> <!-- Usa modal-lg para un tamaño grande -->
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Ya por llegar...</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Aquí coloca tu imagen en la etiqueta img -->
                <img src="../img/mapa.jpg" style="width: 100%; height: auto;">
            </div>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#popup5" id="cont">Continuar</button>
        </div>
    </div>
</div>







    
    <!-- Ventana Emergente 5 - Llegada a Destino -->
<div id="popup5" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Llegada a su destino</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body text-center">
                <img src="../img/auto-aparcado.png" alt="Llegada a su destino">
                <!-- Agregar un elemento con ID "arrivalPosition" para mostrar la posición -->
                <p>Ha llegado a la : <span id="arrivalPosition"></span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="markDeparture">Pagar</button>
                <button type="button" class="btn btn-primary" id="pay">Registrar</button>
            </div>
        </div>
    </div>
    </div>

    <!-- Ventana Emergente 6 - Pago Exitoso -->
<div id="popup6" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <h5 class="modal-title">¡Su pago fue exitoso!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <img src="../img/fondo-index.jpg" style="height: 100px; width:100%;">
                <p>ESCANEAR QR</p>
                <img src="../img/qr.png" class="qr-code">
                <p class="text-warking">HASTA PRONTO</p>
                <div class="row">
                    <div class="col">
                        <img src="../img/impresion.png" alt="Imagen 1">
                        <p>Imprimir boleta</p>
                    </div>
                    <div class="col">
                        <img src="../img/lapiz.png" alt="Imagen 2">
                        <p>realizar factura</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-center">
                <button type="button" class="btn btn-success" id="endt">Terminar</button>
            </div>
        </div>
    </div>
</div>

<!-- Ventana Emergente 7 - Registro de Tarjeta -->
<div id="popup7" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <h5 class="modal-title">¡Registra tu tarjeta!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Numero de tarjeta:</p>
                <input type="text" id="cardNumber">
                <p>Fecha de caducidad (MM/AA):</p>
                <input type="text" id="expiryDate">
                <p>Titular de tarjeta SR./SRA.: <input type="text" id="cardHolder"></p>
                
                <div class="row">
                    <div class="col">
                        <img src="../img/visa.png" alt="Imagen de tarjeta 1">
                    </div>
                    <div class="col">
                        <img src="../img/tarjeta.png" alt="Imagen de tarjeta 2">
                    </div>
                    <div class="col">
                        <img src="../img/amex.png" alt="Imagen de tarjeta 3">
                    </div>
                </div>
                <p>CVV: <input type="text" id="cvv"></p>
                
                <p class="text-danger">Asegúrate de tener compras online activadas</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="registerCard">Afiliarme</button>
                <p>Te hemos enviado un correo.</p>
            </div>
        </div>
    </div>
</div>




    <!-- Enlazar Bootstrap JS, jQuery y Popper -->
    <script src="../bootstrap/jquery.min.js"></script>
    <script src="../bootstrap/popper.min.js"></script>
    <script src="../bootstrap/bootstrap.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var usuarioLogueado = localStorage.getItem('usuarioLogueado');
            if (!usuarioLogueado) {
                // Si el usuario no está autenticado, redirigir a index.html
                window.location.href = 'index.html';
            }
        });
        // Variables para almacenar la posición seleccionada y la entrada
        var selectedPosition = null;
        var selectedEntrance = null;
    
        // Obtener el nombre y apellidos del usuario desde LocalStorage
        var userData = JSON.parse(localStorage.getItem('Usuarios'));
        var loggedUser = localStorage.getItem('usuarioLogueado');
        var userFullName = '';
    
        if (userData && loggedUser) {
            var user = userData.find(function (u) {
                return u.usuario === loggedUser;
            });
            if (user) {
                userFullName = user.nombres + ' ' + user.apellidos;
            }
        }
    
        // Mostrar el nombre y apellidos del usuario
        $('#userFullName').text(userFullName);
    
        // Configurar el aumento de tamaño al hacer clic en las imágenes de los autos
        $('.car-images').click(function() {
            $(this).css('max-width', '100px');
        });
    
        // Configurar el aumento de tamaño al hacer clic en el icono de la cámara
        $('.camera-icon').click(function() {
            $(this).css('width', '100px');
        });
    
        // Abrir la ventana 1 al hacer clic en el icono de la cámara
        $('.camera-icon').click(function() {
            $('#popup1').modal('show');
        });
    
        // Continuar a la ventana 2 desde la ventana 1
        $('#continueToPopup2').click(function() {
            $('#popup1').modal('hide');
            $('#popup2').modal('show');
        });
    
        // Continuar a la ventana 3 desde la ventana 2
        $('#continueToPopup3').click(function() {
            $('#popup2').modal('hide');
            $('#popup3').modal('show');
            localStorage.setItem('tarjetaRegistrada', false);
        });
    
        // Seleccionar entrada en la ventana 3
        $('#selectTottus').click(function() {
            selectedEntrance = 'Tottus';
            $('#popup3').modal('hide');
            $('#popup4').modal('show');
            // Mostrar la entrada seleccionada en la ventana 4
            $('#selectedEntranceInPopup4').text(selectedEntrance);
        });
    
        $('#selectPreferential').click(function() {
            selectedEntrance = 'Preferential';
            $('#popup3').modal('hide');
            $('#popup4').modal('show');
            // Mostrar la entrada seleccionada en la ventana 4
            $('#selectedEntranceInPopup4').text(selectedEntrance);
        });
    
        $('#selectZotano').click(function() {
            selectedEntrance = 'Zotano';
            $('#popup3').modal('hide');
            $('#popup4').modal('show');
            // Mostrar la entrada seleccionada en la ventana 4
            $('#selectedEntranceInPopup4').text(selectedEntrance);
        });
function showPositionInPopup5() {
    var storedPosition = localStorage.getItem('selectedPosition');
    if (storedPosition) {
        $('#arrivalPosition').text('Posición ' + storedPosition);
    }
}
$('#cont').click(function() {
    $('#popupmapa').modal('hide');
});
// Cerrar la ventana 4 y abrir la ventana 5
// Marcar la posición seleccionada en la ventana 4
$('#markPosition').click(function() {
    // Reiniciar selectedPosition
    selectedPosition = null;

    // Recorrer las casillas para verificar cuál está seleccionada
    for (var i = 1; i <= 8; i++) {
        if ($('#position' + i).prop('checked')) {
            selectedPosition = i;
            break;
        }
    }

    // Evitar que las casillas 3, 5 y 8 se puedan marcar
    if (selectedPosition === 3 || selectedPosition === 5 || selectedPosition === 8 ||selectedPosition === null) {
        alert('Seleccione una posicion correcta...');
    } else {
        // Si se seleccionó una posición válida, guardarla en el LocalStorage
        localStorage.setItem('selectedPosition', selectedPosition);
        $('#popup4').modal('hide');
        $('#popupmapa').modal('show');
    }
});


// Mostrar la posición en la ventana 5 cada vez que se muestra
$('#popup5').on('show.bs.modal', function (e) {
    showPositionInPopup5();
});
$('#registerCard').click(function() {
    localStorage.setItem('tarjetaRegistrada', true); 
    alert("tarjeta registrada con exito", localStorage.getItem('tarjetaRegistrada'));
    // Cierra la ventana 7
    $('#popup7').modal('hide');
    $('#popup5').modal('show');
    
});

    
        // Cerrar la ventana 5 y abrir la ventana 6
        $('#markDeparture').click(function() {
            $('#popup5').modal('hide');
            $('#popup6').modal('show');
        });
    
        // Cerrar la ventana 5 y abrir la ventana 7
        $('#pay').click(function() {
            $('#popup5').modal('hide');
            $('#popup7').modal('show');
        });
        

// Ventana 7 - Afiliarse
$('#registerCard').click(function() {
    $('#popup7').modal('hide');
    $('#popup5').modal('show');
    
});
$('#endt').click(function() {
    // Abre la ventana 7
    $('#popup5').modal('hide');
    $('#popup6').modal('hide');


});
document.getElementById('cerrarSesion').addEventListener('click', function () {
    // Eliminar los datos del usuario logueado y la posición seleccionada del localStorage
    localStorage.removeItem('usuarioLogueado');
    localStorage.removeItem('selectedPosition');
    
    // Redirigir al archivo index.html
    window.location.href = 'index.html';
});

    </script>
    
    
</body>
</html>
